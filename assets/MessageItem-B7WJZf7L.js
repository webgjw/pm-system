import{H as h,a as T,n as V,f as l,o as m,c as v,d as a,e as d,w as g,i as y,t as r,h as w,F as I,v as U,U as q,V as F,W as D,k,A as f,r as H,X as L,T as W}from"./index-DHRVARTs.js";const X=e=>{const s=e.type;return delete e.type,h({url:`/message/list/${s}`,method:"get",data:e})},j=e=>{const{id:s,type:t}=e;return delete e.id,delete e.type,h({url:`/message/read/${t}/${s}`,method:"post",data:e})},G=e=>{const s=e.type;return delete e.type,h({url:`/message/readAll/${s}`,method:"post",data:e})},J=e=>{const{id:s,type:t}=e;return delete e.id,delete e.type,h({url:`/message/${t}/${s}`,method:"delete",data:e})},K={key:0},O={class:"txt-r"},Q={class:"events"},Y={class:"label"},Z={class:"content"},ee={class:"summary"},te={class:"date"},se={class:"extra text"},ne={class:"actions"},oe={class:"flex-center"},ae={key:1},le={class:"nodata txt-c"},ie={__name:"MessageItem",props:{type:String},setup(e){const s=k([]),{t}=T(),C=e,i=H({pageNum:1,pageSize:20}),x=k(0),_=L(C,"type"),p=()=>{const{pageNum:c,pageSize:n}=i;X({type:_.value,pageNum:c,pageSize:n}).then(u=>{s.value=u.data.content||[],x.value=u.data.totalSize||0}).catch(()=>{s.value=[]})},z=c=>{j({type:_.value,id:c}).then(()=>{f.success(t("tips.success")),p()})},S=()=>{G({type:_.value}).then(()=>{f.success(t("tips.success")),p()})},N=c=>{W.confirm(t("tips.deleteConfirm"),t("tips.deleteTitle"),{confirmButtonText:t("action.confirm"),cancelButtonText:t("action.cancel"),type:"warning",draggable:!0}).then(()=>{J({type:_.value,id:c}).then(()=>{f.success(t("tips.success")),p()})})};function $(c){i.pageSize=c,i.pageNum=1,p()}function B(c){i.pageNum=c,p()}return p(),(c,n)=>{const u=w,E=V("comment"),M=q,b=F,R=D;return l(s).length?(m(),v("div",K,[a("div",O,[d(u,{plain:"",type:"primary",onClick:n[0]||(n[0]=o=>S())},{default:g(()=>[y(r(l(t)("action.markedAllRead")),1)]),_:1})]),a("div",Q,[(m(!0),v(I,null,U(l(s),(o,A)=>(m(),v("div",{class:"event",key:A},[a("div",Y,[d(b,{"is-dot":!o.isRead},{default:g(()=>[d(M,null,{default:g(()=>[d(E)]),_:1})]),_:1},8,["is-dot"])]),a("div",Z,[a("div",ee,[y(r(o.title)+" ",1),a("div",te,r(o.date),1)]),a("div",se,r(o.content),1),a("div",ne,[d(u,{type:"text",disabled:o.isRead,class:"action a-read",onClick:P=>z(o.id)},{default:g(()=>[n[3]||(n[3]=a("i",{class:"el-icon-edit"},null,-1)),y(" "+r(l(t)("action.markedRead")),1)]),_:1},8,["disabled","onClick"]),d(u,{type:"text",class:"action a-delete",onClick:P=>N(o.id)},{default:g(()=>[n[4]||(n[4]=a("i",{class:"el-icon delete"},null,-1)),y(" "+r(l(t)("action.delete")),1)]),_:1},8,["onClick"])])])]))),128))]),a("div",oe,[d(R,{currentPage:l(i).pageNum,"onUpdate:currentPage":n[1]||(n[1]=o=>l(i).pageNum=o),"page-size":l(i).pageSize,"onUpdate:pageSize":n[2]||(n[2]=o=>l(i).pageSize=o),total:l(x)||0,layout:"prev, pager, next",onSizeChange:$,onCurrentChange:B},null,8,["currentPage","page-size","total"])])])):(m(),v("div",ae,[a("div",le,r(l(t)("nodata")),1)]))}}};export{ie as default};
